FROM quay.io/opendatahub/workbench-images:cuda-ubi9-python-3.9-20231206
ARG PORT
WORKDIR /locallm
COPY src .
RUN pip install --upgrade pip
ENV CMAKE_ARGS="-DLLAMA_CUBLAS=on"
ENV FORCE_CMAKE=1
RUN pip install --no-cache-dir --upgrade -r /locallm/requirements.txt
EXPOSE $PORT
ENTRYPOINT [ "sh", "run.sh" ]